<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ECOSTATS</title>

<meta name="keywords" content="" />
<meta name="description" content="">
<meta name="author" content="Akira Terui">
<link rel="canonical" href="https://ecological-stats.netlify.app/" />
<link href="/assets/css/stylesheet.min.d08f6c302eba3eaecd589684c093cecdfe7dfb8745a207401bd0583d3bb31837.css" integrity="sha256-0I9sMC66Pq7NWJaEwJPOzf59&#43;4dFogdAG9BYPTuzGDc=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://ecological-stats.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ecological-stats.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ecological-stats.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ecological-stats.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://ecological-stats.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.81.0" />
<link rel="alternate" type="application/rss&#43;xml" href="https://ecological-stats.netlify.app/index.xml">
<link rel="alternate" type="application/json" href="https://ecological-stats.netlify.app/index.json">



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-175522371-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta property="og:title" content="ECOSTATS" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://ecological-stats.netlify.app/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ECOSTATS"/>
<meta name="twitter:description" content=""/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "ECOSTATS",
  "url": "https://ecological-stats.netlify.app",
  "description": "",
  "thumbnailUrl": "https://ecological-stats.netlify.app/favicon.ico",
  "sameAs": [
      "https://github.com/aterui", "index.xml"
  ]
}
</script>


</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }
    </style>

</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ecological-stats.netlify.app" accesskey="h" title="ECOSTATS (Alt + H)">ECOSTATS</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                
                
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://ecological-stats.netlify.app/archives/" title="archive">
                    <span>archive</span>
                </a>
            </li>
            <li>
                <a href="https://ecological-stats.netlify.app/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://ecological-stats.netlify.app/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li></ul>
    </nav>
    
    <script data-ad-client="ca-pub-8263637323017170" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
</header>

    <main class="main"> 


<article class="first-entry home-info">
    <header class="entry-header">
        <h1>ECOSTATS</h1>
    </header>
    <section class="entry-content">
        <p>RやJAGSの備忘録。管理者は生態学を専門にしているため、関連分野の情報が中心になります。そのほか、研究雑記など。このサイトに関する責任は全て管理者個人に帰すもので、所属機関ならびにその上位機構は内容について関知していません。なお、当サイトでは、第三者配信の広告サービス（<a href="https://www.google.com/adsense/start/">Googleアドセンス</a>）を利用しています。このような広告配信事業者は、ユーザーの興味に応じた商品やサービスの広告を表示するため、当サイトや他サイトへのアクセスに関する情報 『Cookie』(氏名、住所、メール アドレス、電話番号は含まれません) を使用することがあります。</p>
    </section>
    <footer class="entry-footer"><div class="social-icons"><a href="https://github.com/aterui" target="_blank" rel="noopener noreferrer me"
        title="Github"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg></a><a href="index.xml" target="_blank" rel="noopener noreferrer me"
        title="Rss"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg></a></div>
</footer>
</article>




<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Rの使えるパッケージ/ショートカット
    </h2>
  </header>
  <section class="entry-content">
    <p>Packagetidyversepatchworksf/raster/stars/exactextractrwhiteboxShortcutCode block label (Ctrl &#43; Shift &#43; R)Multi-line (un)comment (Ctrl &#43; Shift &#43; C)Pipe (Ctrl &#43; Shift &#43; M)Packagetidyverseデータ整理や図表作成に有用なさまざまなパッケージをまとめたもの。もはやこのパッケージなしにはRを使えない。とくにdplyr およびggplot2 に含まれる関数群にはお世話になりっぱなしである。このあたりの関数の使い方はWeb上にあふれているので割愛。dplyrであればHeavyWatalさんのWebsiteが分かりやすい。ggplot2に関してはFrom data to Vizがビジュアルから入れるのでとっつきやすい。
patchworkggplot2とセットで使うとことを想定したパッケージ（patchwork）。データフレームをグループごとにプロットする場合、facet_wrapやfacet_gridなどの関数を使うことが多いと思う。これらは非常に有用な関数なのだが、すべてのパネルで同じ構造（xとyが一緒など）をとる必要がある。しかし、論文の図を作る時、フォーマットの異なる図を横に並べて一つの図としてまとめたいことも多いと思う（例えば散布図と箱ひげ図を並べる、など）。そんなときに役立つのがpatchworkである。このパッケージを使うと、複数のggplotオブジェクトを好きなように配置できる。irisを使って例を下に示す。
pacman::p_load(tidyverse,patchwork)# scatter plotg1 &lt;- iris %&gt;% ggplot(aes(x = Sepal.Width,y = Sepal.Length,color = Species)) &#43;geom_point(alpha = 0.3) &#43;theme_bw()# box plotg2 &lt;- iris %&gt;%ggplot(aes(x = Species,y = Sepal....</p>
  </section>
  <footer class="entry-footer">

April 9, 2022&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to Rの使えるパッケージ/ショートカット" href="https://ecological-stats.netlify.app/2022/04/09/r-package-shortcut/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      論文を書くときの留意点
    </h2>
  </header>
  <section class="entry-content">
    <p>StructureIntroductionMethodsResultsDiscussionAdditional pointParagraphSentence論文のドラフトをあげたら、以下の点を確認する。
StructureIntroductionパラグラフ間の論理的つながりが明確
大きな枠組みの中で新奇性を述べている
対象とするシステムの「必然性」が明確
データの質と整合性が取れている
仮説が単純かつ明快
Methods情報を出す順番が適切
パラグラフごとに情報が整理されている
理論・統計は専門外の人にも伝わるように書かれている
パラメータ名の重複や説明漏れがない
パッケージやソフトウェアのVersion情報に誤りがない
ResultsMethodsを詳しく読まずとも結果が理解できる
結果の意味するところが述べられている
不確実性の記述が適切
効果量の記述が明確
Discussion仮説・問いに対する答えが明確であり、答えの意義を広い枠組みのなかで捉えている（最初のパラグラフ）
各結果の解釈が端的に述べられている
複数の解釈がある場合、それらが網羅されている
弱みや限界に言及がある
今後の大きな展開がイメージできる（最後のパラグラフ）
Additional point読み落とされたくない重要情報は表現を変えて複数個所に配置する（MethodsとDiscussionなど）...</p>
  </section>
  <footer class="entry-footer">

December 7, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to 論文を書くときの留意点" href="https://ecological-stats.netlify.app/2021/12/07/checkpoint/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      水系網の形の意味
    </h2>
  </header>
  <section class="entry-content">
    <p>一見、線のようにみえる川ですが、上から俯瞰すると様々な川が合流を繰り返し、まるで樹木のような形をした「水系網」を作り上げます。その成因について、地形学や水文学の観点から長く研究されてきました。一方、この水系網の樹状形は、そこにすむ生物の成り立ちとどんな関わりがあるのでしょうか？
オーストラリア中央部にみられる樹状の水系網。 Photo Credit: Google Earth https://www.google.co.jp/intl/ja/earth/
ここ数年、私はこのテーマにかかわる研究を進めて来ました。その結果、水系網の分岐構造が複雑になるほど、（１）そこにすむ生物の集団はより安定的に維持され（Terui et al. 2018, PNAS）、（２）流域全体の生物多様性は高くなり（Terui et al. 2021, PNAS）、（３）さらには食物連鎖の長短にまで波及する（Pomeranz et al. 2021, preprint）ことが分かってきました。複雑な水系網では環境が多様なため、さまざまな生物を支える基盤が整っている、というのがおおざっぱな説明です。手法としては、自然界で起きているであろう生物と環境の相互作用を数式として記述し、そこから導かれる予測を現地データで検証しています。
いまになって論文化していますが、これらの発想はいずれも、博士課程在学時（2011-2014年）に川を泳いでいるときに思いついたものです。私の博士課程の研究は、川にすむカワシンジュガイという生物の空間的な分布を調べ、その成因を探るものでした（専門的にはメタ個体群構造を調べる；Terui et al. 2011, 2014）。その過程で、北海道の朱太川を4年かけて泳ぎまわりました（合計90km）。それほどアウトドアな人間ではない私は、ひとつの流域の中にある川が、これほど多様であることを知りませんでした。泳ぎながら貝を探していく中で、いくつもの川との合流地点を通り過ぎるのですが、合流を境に急に水が冷たくなったり、逆に温かくなったり、ときには底石の感じが変わったりするのです。川によって水の由来（湧水かそうでないか、など）や石の供給源（山）が変わるからなのですが、この調査をするまで気にも留めていませんでした。このとき、多様な川が織りなす「水系網」に強い興味がわきました。水系網の複雑さは、生物多様性を支えるとても重要な要素なのでは、と（これは川をよく見ている方なら感覚的にわかっていることと思います）。
2011年の北海道・朱太川における調査。写真中央は共同研究者であり、魚類研究者の宮崎博士。
しかし、当時はこの発想を科学へと昇華させることができませんでした。なぜなら、数理モデルやビッグデータを扱う能力がなく、この感覚的な仮説を科学の言葉で表現できなかったからです。仮に私がそうした技術を持ち合わせていても、当時の知識の乏しさから生態学における適切な位置づけを与えることができず、有象無象の研究として埋もれていたことでしょう。このため、しばらくはこの発想もとに研究を進めることはできず、学位取得後のポスドク期の後半に至るまで（2014-2017年）、全く別の研究に時間を投資しました。
転機があったのは2017年です。ポスドクのプロジェクトで関わっていた研究者の方が、北海道の保護水面で20年近く魚類のモニタリングが行われていることを教えてくれたのです。このとき、長い間抱えていた妄想が現実味を帯びはじめました。このモニタリングでは、多数の流域で魚類群集の時間変化が調べられており、水系網の形の意味を調べる上でまさに理想的なデータだったからです。さらにポスドク中、以前から興味のあった数理モデルの勉強を独学で進めていたので、このころには自分でシミュレーションモデルを作れるようになっていました。水系網の研究分野では、生態学の理論的枠組みが整理されていなかったので、それならば「自分で数理モデルの枠組みを作り、そこから導かれる予測をこの現地データで検証しよう」と考えました。そこから数年の間に渡米したのですが、その後に出会ったアメリカの研究者の協力もあり、今では日米をまたがる研究へと進展しました。こうして振り返ってみると、「過去のとりとめのない妄想」と「後に全く別目的で得た研究技術」の邂逅が、最近の研究成果につながったと言えます。いつ、どこで何が役に立つのか、本当にわからないものです。（もちろん、研究の実現にあたって、私に足りない部分を補ってくれた共同研究者の方々の協力が欠かせなかったことは言うまでもありません。）
生態系の構造的複雑さに注目する研究者は世界でも数えるほどしかいませんが、今回の一連の研究が、この研究分野の発展につながればと思います。個人的には、全く別の生態系 ‐ 例えば樹木や草本の樹状構造 - でも、それらを生息場とする微生物などで似た現象が起きそう、と考えています。</p>
  </section>
  <footer class="entry-footer">

November 27, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to 水系網の形の意味" href="https://ecological-stats.netlify.app/2021/11/27/branching/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Rでシミュレーション3 - foreach
    </h2>
  </header>
  <section class="entry-content">
    <p>パラメータセットを用意するforeachの導入Plotを描く前回はfunctionを使ってシミュレーションモデルを関数化する方法を書いた。今日はこの関数を使い、様々なパラメータの下でシミュレーションを効率的に走らせるコードを書いてみたい。
パラメータセットを用意する以前作った個体群動態のシミュレーションモデルを、ここの例題として再度利用する：
\[ln~n_{t&#43;1} = ln~\lambda &#43; ln~n_t &#43; \epsilon_t\\\epsilon_t \sim N(0,\sigma_{\epsilon}^2)\]
前年の個体数\(n_{t}\)に集団増加率\(\lambda\)が掛け算され、翌年の個体数\(n_{t&#43;1}\)が決まるが、そこにはランダムな環境変動の影響（\(\epsilon_t\)）もある、というものであった（上の式では対数スケールのため足し算になっている）。これをコードとして書き下し、関数化したものが以下：
sim_geomodel &lt;- function(n_step,lambda,sd_eps,n1 = 10) {log_n &lt;- NULLlog_n[1] &lt;- log(n1)eps &lt;- rnorm(n = n_step, mean = 0, sd = sd_eps)for(t in 1:(n_step - 1)) {log_n[t &#43; 1] &lt;- log(lambda) &#43; log_n[t] &#43; eps[t]}n &lt;- exp(log_n)df_dynamics &lt;- dplyr::tibble(n_step = 1:n_step,n = n)return(df_dynamics)}この関数sim_geomodelを使い、パラメータの値を変えた時に、50年後の個体数の予測値がどう変わるのか調べてみよう。パラメータを変えながらパターンを予測することで、どのパラメータが集団動態にどんな影響を及ぼすのかを調べることができる。今回の場合、パラメータは二つあるので（lambda, sd_eps）、これらのパラメータセットを作るところから始める。パラメータセットを作るには、パラメータ値のすべての組み合わせを考える必要がある。この場合、expand....</p>
  </section>
  <footer class="entry-footer">

May 30, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to Rでシミュレーション3 - foreach" href="https://ecological-stats.netlify.app/2021/05/30/foreach/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Rでシミュレーション2 - function
    </h2>
  </header>
  <section class="entry-content">
    <p>functionの導入シミュレーションを関数化前回はfor構文を使った至極簡単なシミュレーションモデルを作ってみた。しかし、中には「こんなめんどくさいスクリプトを毎回書くのか。。。？」などと思われた方もいると思う。そんなことはないので安心してほしい。一つのまとまった作業を関数化することで、スクリプトの量をかなり減らすことができる。
functionの導入function関数を使うことで一度書いたモデルを使いまわすことができる。最初からシミュレーションモデルを関数化すると説明が煩雑になってしまうので、まずは変動係数CVを推定する関数mycv なるものを作ってみよう。まずは正規分布に従う乱数をrnormを使って生成する。
# 100 random values following a normal distributionset.seed(123) # for reproducibilityy &lt;- rnorm(n = 100, mean = 50, sd = 25)# show the first 10 elementsprint(y[1:10])## [1] 35.98811 44.24556 88.96771 51.76271 53.23219 92.87662 61.52291 18.37347## [9] 32.82868 38.85845変動係数は以下のスクリプトで推定できる。
cv &lt;- sd(y) / mean(y)print(cv)## [1] 0.4366692しかし、なんだか毎回二つの関数sd とmean を組み合わせて変動係数を計算するのは面倒くさい。なので、これらの作業を一挙にやってくれる関数をつくってみよう。
mycv &lt;- function(x) {cv &lt;- sd(x) / mean(x)return(cv)}x という引数に基づいて、SDを平均で割るという作業を自動的にやってくれる関数mycv を定義している。function() のカッコの中に引数として使いたい変数をいれておく。そうすると、そこに使ってほしい値をぶち込むと、関数内で定義された作業を自動的に行ってくれる。return のところでは、何を計算結果（返り値）として返してほしいかを指定している。早速mycv を使ってみる。以下では、x = y とし、関数内のx にy を「代入」している。...</p>
  </section>
  <footer class="entry-footer">

April 11, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to Rでシミュレーション2 - function" href="https://ecological-stats.netlify.app/2021/04/11/function/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      Rでシミュレーション1 - for loop
    </h2>
  </header>
  <section class="entry-content">
    <p>なぜシミュレーション？for loop集団動態モデルランダムネスを加えるモデルの拡張なぜシミュレーション？生態学に慣れ始めてきたころ、いわゆる「理論研究」と言われる類の論文も読み始めるようになった。最初は難解で何をしているのかわからなかったが、分かってくるととても力強いアプローチだなぁと感じるようになり、自分で作ってみたいと思うようになった。というのも、私はフィールドを中心に研究をしていたけれども、野外のデータはあまりにも雑多で、その解釈に困ることが多かったからだ。例えば、ある魚と別の魚が餌をめぐる競争関係に興味があり、「この二種は競争関係にあるので、一方の個体数が多い場所では、もう一方の個体数は少なくなる」という仮説を立てたとしよう。野外で両種の個体数の間に負の相関が認められたとしても、「おお仮説通りのパターンだ、競争に違いない！」と単純に喜ぶことはできない。同じパターンを生み出す仕組みがあまりにもたくさんあるからだ（両者の好きな環境が全く異なるだけかもしれない）。
こうした理由から、自分がフィールドで集めたデータをもとに論文を書くとき、（特にDiscussionで）もどかしい思いをする。思いっきり「これだ！」と断言したいのに、あれやこれやと言い訳しなければならないからだ。実験で検証可能な仮説ならば、実験するに越したことはない。しかし、見たい現象が生態系スケールとかになってくると、実験などほぼ不可能だ。できたとしても億単位の研究費が必要になる。
そんなとき、シミュレーションが役に立つ。ある仕組みをこちらで勝手に想定し、そこから導かれるパターンがどんなものかを見るのがシミュレーションだ（生態学の数理モデルが全般的にそうですが）。つまり、観察されたパターンから仕組みを推論する統計モデリングの全く逆のことをするといってもいい（Figure 1）。興味のある仕組み以外を排除あるいはコントロールできるので、その仕組みがどんな時にどんなパターンを生み出すのか知ることができる。
Figure 1: Conceptual diagram for the roles of theoretical and statistical models. Theoretical models (generally) predict patterns under certain mechanisms (and assumptions) while statistical models infer mechanisms behind observed patternsと、ここまでは論文を読んでいれば納得できるのだが、いかんせんどうやってスクリプトを書けばいいのかわからない…というのが学生のころの悩みだった。統計解析のリソースはオンラインにかなり落ちているので自分でいくらでも勉強できたが、シミュレーションモデルは本当にスクリプトのリソースが少ない。あったとしても、これからやろうとしている人向けには書かれていない。それが今回の（たぶんシリーズ的に）書こうと思っているポストのモチベーション。
for loopこまごましたことはあるのだが、まずはfor構文をつかって簡単なシミュレーションモデルを作ってしまおう。for構文とはなんぞや、という人もいるかもしれないので、ここで簡単に説明しておく。端的にいうと、コンピュータに「同じ作業を繰り返せ」と指令するコマンド。for(i in 1:3) { XXX }という形で書くのだが、これはiがイテレータと呼ばれるもので、繰り返しのユニットに対応するものだ。このスクリプトで言えば、「XXXという作業を1から3まで回してほしい」と指令している。これだとわかりにくいので、下の例をみてみよう。
# create a vector with 11, 12, 13y &lt;- NULLx &lt;- 11:13for(i in 1:3) {y[i] &lt;- x[i] * 2}ここではyとxというオブジェクトを作り、xのほうに11から13の値を代入している。やりたいことは、xの値をそれぞれ2倍することである。for構文の中身は次のように展開できる（下付き文字がイテレータに対応している）。...</p>
  </section>
  <footer class="entry-footer">

March 29, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to Rでシミュレーション1 - for loop" href="https://ecological-stats.netlify.app/2021/03/29/for-loop/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      回帰モデルの効果量
    </h2>
  </header>
  <section class="entry-content">
    <p>効果量としての標準化偏回帰係数Average predictive comparisonRで実装効果量としての標準化偏回帰係数線形回帰は、生態学の一般的な解析手法になっている。Rで多数の関数が用意されているため解析も容易で、回帰係数の95%信頼区間やp値などでその効果の有意性もカンタンに検討できる。一方、近頃では有意性だけでなく、「効果量（Effect size）」にも注目したほうがいいとの見方が広まっている。この効果量には様々な指標があるけれども、線形回帰の文脈でいえば標準化偏回帰係数がもっとも広く使われている。
そもそも偏回帰係数の意味とは何かというと、対応する説明変数xが単位量（つまり1.0）だけ増えたときに、応答変数がどれだけ変化するかを示している。しかし、説明変数間で単位*1が違うと（例えばある変数はm単位で計られているのに対し、別の変数は㎝単位で計られている）、偏回帰係数はその単位の違いの影響を直に受けてしまう。そこで、それぞれの説明変数をそのばらつき（標準偏差SD）で割り（標準化）、それら標準化された説明変数に対する偏回帰係数を推定する。標準化された説明変数の単位はそろっているので、推定された標準化偏回帰係数も比較できるものになっているはず、というものだ。
しかし、これには一つの問題がある。現代の一般的な統計モデルでは、効果量としての標準化偏回帰係数の解釈が「直感的ではない」のである。例としては以下のようなものがある。個体数のカウントデータを線形モデルで表現する場合、誤差構造としてはポアソン分布（あるいは負の二項分布）を用いることが多い。ポアソン分布の平均パラメータは負の値をとることができないので、Rではデフォルトで対数リンク関数が実装されている。この時、ポアソンモデルの偏回帰係数のなにがどう「直感的」でないのか、下の例を見ながら考えてみる。
まず、下記のスクリプトで簡単な仮想データを作る。
# simulated data set.seed(111)n_sample &lt;- 100x1 &lt;- rnorm(n_sample, mean = 10, sd = 1)x2 &lt;- rnorm(n_sample, mean = 10, sd = 3)X &lt;- model.matrix(~ x1 &#43; x2)b &lt;- c(0.1, 0.2, 0.2) # true parametersy &lt;- rpois(n_sample, exp(X %*% b)) # simulated yポアソン分布を仮定したGLMを当てはめる。
\[\begin{equation}y_i \sim Pois(\lambda_i)\\ ln \lambda_i = \alpha &#43; \beta_1 x_{1,i} &#43; \beta_2 x_{2,i}\end{equation}\]# model fit; unstandardizedm &lt;- glm(y ~ x1 &#43; x2, family = poisson)coef(m)## (Intercept) x1 x2 ## 0....</p>
  </section>
  <footer class="entry-footer">

March 28, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to 回帰モデルの効果量" href="https://ecological-stats.netlify.app/2021/03/28/average-predictive-comparison/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      学振受け入れ先
    </h2>
  </header>
  <section class="entry-content">
    <p>理論と実証の統合河川魚類群集のビッグデータ生物の移動パターン&#43;アルファ連絡先私の運営する研究室では、海外学振あるいは学振PD、DCの制度を利用した研究員の受け入れを積極的に行っていきたいと考えています。私の研究室では以下のような興味を持った方が特に恩恵を得られると思います。
理論と実証の統合私の研究室では理論と実証の統合に重きを置きたいと思っています。以下のような興味をもつ人が特にマッチングがよいと考えています。（１）これまでフィールドばかりやってきたが、理論も取り入れてもっと説得力のある研究デザインを組みたい、（２）理論をやってきたが、これからは実証も見据えた理論研究を展開したい。
私がカバーしている理論研究の分野は、生態系におけるネットワーク構造と集団・群集構造の関係、食物連鎖長の制限要因、生物の移動とそれが支える個体群構造に関する理論、などですが、例えば進化的視点を取り入れられるような方が来てくれると私の視点も広がるのでとてもうれしいです。
河川魚類群集のビッグデータ当研究室では、魚類群集の大規模データにアクセスがあります。例えば、日本の北海道全域およびアメリカ中西部において、20000点を超える場所で調査した魚類群集データ（*）を整備したものがありますので、このデータベースを利用した研究計画を立てることが可能です。時系列データに関しても、北海道であれば100地点以上における20年にわたる魚類群集の継続的モニタリングデータがありますし、昨年には共同研究を通じてグローバルスケールで時系列データを収集したデータベースも出版しています（RivFishTIME）。これらのデータのシェアを通じ、国内外の共同研究者とも積極的に議論をしていく良い機会にもなると思います。また、これらのデータを用い、理論予測の検証に用いることも可能だと思います。
＊既存の文献や州政府からデータ提供を受けたものです（私もごく一部のデータは集めてますが）。貢献された方々に感謝。
生物の移動パターンデータベースではなかなか得られない「生物の移動」に関するデータを現地で集めています。私の所属するノースカロライナ大学グリーンズボロ校には、サテライトキャンパス（車で20分ほど）に小河川が流れています。ここではちょうどいい種数（Sunfish 3種、Chub 2種が群集の8-9割を占める川）があり、これらの魚種の移動が何に影響されているのかを調べています。長期的なプランとしては、詳細な移動パターン（移動の個体差など）が集団動態の安定性あるいは多種共存にどう関わっているのかを追求したいと考えています。
このサイトを活かしたフィールド研究あるいは理論予測の実証などを特に歓迎しますが、ほかにもザリガニや巻貝などの生物も多数いますので、本人の興味に応じて研究プロジェクトを拡張することも可能です。そのほか、もう少し離れた場所であればもっと原生的な河川でも調査が可能ですので、時間に余裕をもって相談くだされば調整可能です。
&#43;アルファ補足的な要素として、私は海外学振からアメリカで就職した経歴がありますので、そのあたりの経験をシェアすることも可能です。文化的に日本とかなり異なるところが多いので、そういった意味ではサポートできるかもしれません。アメリカ国内の研究者とのコネクションづくりをお手伝いもできると思います。
連絡先そのほか、河川-陸域の食物網のつながりや、水系網と鳥類の分布の関係などにも興味があります。もちろん、上記にないようなテーマでも、可能な限りサポートしたいと考えています。興味のある方は照井a_terui at uncg.eduまでご連絡いただけますと幸いです。
</p>
  </section>
  <footer class="entry-footer">

February 7, 2021&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to 学振受け入れ先" href="https://ecological-stats.netlify.app/2021/02/07/jsps-ad/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      研究者もどきの憂い
    </h2>
  </header>
  <section class="entry-content">
    <p>学振渡米現在注釈学振Twitterを見ていると、学振に受かった・落ちたという投稿がタイムラインをにぎわせている。博士取得後、私は3年にわたり学振（注釈1）に落ち続け（学振PD、海外学振）、不採択の申請書ばかりがむなしくHDDに溜まっていくのがしんどかったのを覚えている（特に2015年申請時に、PD・海外ともに面接で落ちた時はかなりコタエタ）。今は幸いにも、研究室をリードする職を得ることができ、経済的にもゆとりをもった生活を送ることができている。別の形のプレッシャーも大きいのだが（今も4年後のテニュア審査に通らないとぷー太郎に逆戻り）、勝負の土俵に上がれているだけポスドク時（注釈2）の得体の知れない不安よりはマシかもしれない。「このまま何にもなれずに終わるのではないか」という、あれ。
2014年2月、学振に落ち行くアテのなかった私は、某研究室に弾丸出張を行い、（頼まれていもいない）セミナーをしてきた。その結果、温情処置で雇ってもらえた。この時、この研究室に雇ってもらえていなかったら研究者の道をあきらめていたと思う。プロジェクト雇用にもかかわらず、大枠さえ抑えていれば自由に研究をさせてくれ、研究環境という意味においては学振以上だったと思う（自分の業績の9割はこのころのアウトプット）。今の研究も、このころの人脈や経験がベースになっているものが多い。本当に楽しかった。
しかし、もともと予算のないところに無理を言ってねじ込んでもらっていたので、経済的ゆとりがあるわけではなかった（決してこのことに文句を言っているわけではないです）。やる気でなんとかなると思ってたのだが、やはりお金は大事だった。お金がなくなると、人間の本質がでる。自分の場合、まず相手のことを考えれなくなった。何よりも先に家計簿が頭をよぎる。家計簿基準で判断するようになり、本質的にもっと大事であったはずのものを切り捨てたりする。そういう精神状態の中、「いくつ論文を書いたら十分なんだろう」という答えのない疑問が頭の中をめぐり、気が付くと「論文」と独り言をつぶやくようになっていた。申請書は通らない。研究が楽しいからやっていたのか、研究者になるために研究をやっているのかわからなくなる。研究が楽しくなければ、研究者になる意味などないのに。2015年冬、同年に学振PDと海外学振に面接で落ち、これでもかというくらい落ち込んだ時期があった。その話を実家に帰って兄に話すと、軽い笑い話にされたのも「いい思い出」だ。
このころ（27 - 30歳）、友人たちの結婚ラッシュの時期でもあったけど、式にご招待いただいたにもかかわらず、ほぼすべて断ってしまった。ほんとごめんなさい。行きたかったけど、行っていたら次の月に食べるものがなかった。体裁を気にせず親に頼るという選択もあったかもしれないが、両親は私が学部生のころから年金暮らしだったので、さすがにそのお金を食いつぶすことはできないと思った（ただ、一度だけ本当にどうしようもなくなり親に10万円借りた；情けない）。幸い、生態学の分野で研究していると、山菜や釣りで自給自足する仙人のような人が必ず周りにいる。ポスドク3年目の春、車検による経済破綻を経験したが（食料を買う金がない）、友人が行者ニンニクとエゾエンゴサクの取り方・食べ方を教えてくれたことで食に困ることはなかった（＋釣り）。もう一度、彼と山菜を取りにいきたい。
渡米2017年、3度目の正直で海外学振に採用され、4月から渡米した。給料の高さに脱力する（それでも会社勤めの人からしたら普通かそれ以下；社会保障皆無）。このころには論文の「数」は十分と思える程度になっていたが（たしか主著8＋共著9）、「これだ」と自分で思える業績はなかった。なので、経済・時間ともにゆとりのあるこの学振期間に（さながらスターをとったマリオ；最強だが期間は短い）ガツンとした論文を出せなかったら研究者の道はあきらめようと自分ルールを決め、二つの研究に焦点を当てて時間を費やした（数は捨て置いた）。また、先輩研究者を見ていると、大学の常勤職（つまり、助教以上）につくと、野外調査に割く時間はほとんどないように思えた。なので、このころに理論研究もできるようになっておいてたほうがいいと思い、シミュレーションモデルを自分で作れる程度のスキルを磨くことにした。ミネソタ大学の受け入れ研究者が人格者であったことも幸いし、いくつか自分の代表作と思える論文を出すことができた。この段階で初めて、「テニュアトラック（*注釈3）に応募しよう」と思えるようになり、ヨーロッパ・アメリカ・日本のポジションに応募し始めた。海外のポジションは難しいだろうと思っていたが、結局日本のポジションにはすべて落ち、アメリカの大学だけが採用してくれた。人生何が起こるかわからない（ちなみに当方、30歳でアメリカにくるまで海外在住経験はない）。
現在今度は研究資金獲得の争いの中にいる。その不安を前に向かう力にうまく変換する思考回路を身に着けたい。幸せか？と聞かれれば、確かに幸せだ。研究を続けられる立場にいるし、これこそ自分が望んでいたものだ。けれども、その代償となった別の何かを想像し、複雑な気持ちになることがある。器用ではない自分は、「これは必要な犠牲」と言い訳をしながら前に進んできた気がする。それが単なる言い訳であったことに気付くころには時すでに遅しなわけで。
注釈*注釈１「学振」日本学術振興会が行っている博士号取得者向けのフェローシップ（学振PD、海外学振）の通称。学振PD では国内の研究者に受け入れてもらう形で、3年間自身の研究アイデアをもとに自由な研究活動を展開するための給与と研究資金が与えられる。一方、海外学振では、海外の研究者を受け入れ先として2年間自由な研究活動を展開するための給与が与えられる。いずれも競争率が高く、私のときは学振PDの採択率が10%を切っていた。
*注釈２「ポスドク」博士課程を終えた人たちが就く任期付きの職。通常2-3年任期で、次の職の保証は一切ない。研究室の長がとってきた研究費で雇ってもらう場合、自分で学振などの予算を確保する場合がある。前者はプロジェクトのタスクをこなすことになるので、後者に比べて自由度は低い。
*注釈３「テニュアトラック」終身雇用（テニュア）の可能性がある研究職のことをさす。このポジションをとる過程がもっとも競争が熾烈で、「ポスドク」から「テニュアトラック」に変身すると狂ったように喜ぶ。採用から5年後に審査があり、審査に通ればテニュア、落ちれば解雇。この段階では、論文数、発表雑誌、外部研究費獲得額が主な審査対象となる（＋授業評価、学内委員など）。
</p>
  </section>
  <footer class="entry-footer">

September 27, 2020&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to 研究者もどきの憂い" href="https://ecological-stats.netlify.app/2020/09/27/depressed-scientist/"></a>
</article>

<article class="post-entry"> 

  <header class="entry-header">
    <h2>
      論文英語の差別問題
    </h2>
  </header>
  <section class="entry-content">
    <p>我々日本人が学術論文を発表する際、誰にとっても大きな障壁として立ちはだかるのは「英語」であると思う。少なくとも私の分野では、研究成果は英語論文として国際学術誌に発表しなければ研究業績としては評価されない（職に応募する際に、競争的になれないという意味）。もちろん日本語で論文を書くほうが意味をなすことも多いが（生物多様性保全の分野など）、若手がそれをやると職に就けずに路頭にさまようことになる。しかし、私を含め多くの学生は大学院に入るまでそんな事実など知らないし、私も修士課程に入学当初、ポスドクの人が英語で論文を書き上げているのをみて仰天した覚えがある。絶対できないと思った（実際やればできるのだけど）。この問題は経験を積むにつれ解消される部分もあるが、やはり英語を母国語とする人の文章にはかなわないところは当然ある。論文を投稿し、内容の新規性は認められつつも英語の拙さを理由にリジェクト（掲載不可）されることも確かにある。先日、このことを差別として強く批判する内容がMLに流れており、それをみて思うところがあったので書き残しておこうと思う。
先に述べた「論文英語の差別」問題と必ずしも同じではないが、海外に住むと言語による疎外感、差別感を感じることは少なからずある。私は2017年からJSPSの海外学振の制度を利用してミネソタ大学に2年と少し在籍し、2019年の8月からはUNC Greensboroで働いている。渡航前から多少は英会話に慣れておいたつもりではあったが、やはり現地で支障なく生活するには遠く及ばない。4年目を迎えた今でもコミュニケーションがうまくいかないときがある。こういう時、相手を気遣いながら会話をしてくれる人もいれば、あからさまにめんどくさがる人、なかには嘲笑の笑みを浮かべながら話してくる人もいる。大体後者に真に優秀な人はいないので、そういう人とは単にお付き合いしないようにすれば済む、、、とも思えるのだが、そういう人が部署の要職についていたり、研究資材のお得意先だったりすると非常に困る。耐えるしかないのだ。
と、ここまでであれば単なる「海外生活って大変だよね」という話で終わる。しかし、この経験を踏まえたうえで自分が日本にいた時の経験を振り返ると、とても恥ずかしい気持ちになる。日本の大学にも他の国からくる留学生が多いが、彼ら・彼女らの立場になって何が大変かを考えることができていたかどうかというと、全くできていなかった。自分が米国に来た時、ただ運転免許証をとるだけでもやたら難しく感じたし、車の路上トラブル時にきちんとAAA（米国版JAF）を呼べるかどうか、病気になったら病状をきちんと説明できるかどうか、床屋できちんと「短めでお願いします」といえるかどうか、税金の手続きは…あげればキリがないが、あらゆることに形容しがたい不安が伴う。「当たり前」が「当たり前でなくなる」ことに対する不安なのだと思う。これは経験して初めてわかる類のストレスである。私の場合、言語が英語なのでなんとかなる部分が多いが、日本に留学してくる人は日本語で対応しなければならないし、書面も日本人にすら不可解なものも多い。こうした中で、留学生の人たちがどう耐え忍んでいるのか、想像するだけでもつらい。日本人の留学生への理解度についてみても、米国のそれよりも遥かに劣っているだろう。いつぞや、日本語が話せないまま運転免許試験を受けにきた中国人がおり、その人が日本語を理解できないのをみるにつけ、「これだから、、、日本語できるようになってから来てくれないと困るねぇ」と厭味ったらしく罵声を浴びせた試験官がいたこと思い出す。私が仮に米国でこんなことを言われたら、間違いなく死にたくなる。
話を元に戻すと、先の「論文英語の差別問題」には、この要素が大きく関与していると思う。英語話者の人たちは、非英語話者がどういう英語環境に置かれているかのまったく知らないのである。ある時、日本人の大学院生は論文英語の読み方から指導が始まる、みたいのことを飲み会で話したら、同僚は腰を抜かすほど驚いていた。それほどまで言語の壁は大きいということに、英語話者は気づいていない、あるいは知る機会がない。これはうえで述べたように、「日本から出るまで海外で住むことのつらさをまったく想像できなかった」のと一緒で、経験しないとそのつらさはわからない。
被害者側になると、いかにその問題が大きなものであるかを認識することができるが、する側に「そんなつもりはない」ことが多い。「論文英語の差別問題」を考えるとき、この問題意識の改善から行っていかないと、根本的な問題の解決にはつながらない。つまり、英語話者に、英語の通じない国で長期生活してもらうくらいのことをしないとわかってもらえないと思う。だからこそこの問題は根深く、いつまでたっても改善しないのではなかろうか。だからといってこの問題を放置していいとは思わないが、自分たちが一方的な被害者であることを主張するくらいならば、今一度、自分がしてきたことを振り返り、そこから改善策を探るというのも悪くはないのかもしれない。なにも思いつかないけれど。</p>
  </section>
  <footer class="entry-footer">

July 20, 2020&nbsp;·&nbsp;Akira Terui
</footer>
  <a class="entry-link" aria-label="post link to 論文英語の差別問題" href="https://ecological-stats.netlify.app/2020/07/20/japanese-english-papers/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://ecological-stats.netlify.app/page/2/">Next Page »</a>
  </nav>
</footer>

    </main><footer class="footer">
    <span>&copy; 2022 <a href="https://ecological-stats.netlify.app">ECOSTATS</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>



<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>



<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</body>

</html>
